# User Notifications Module

این ماژول امکان ارسال و نمایش پیام‌های داخلی بین ادمین و کاربران را در قالب یک پکیج مستقل فراهم می‌کند. ساختار ماژول بر اساس الگوی `nwidart/laravel-modules` طراحی شده است و شامل migration، مدل، کنترلر، روت، ویو و Blade component می‌باشد.

## امکانات
- ایجاد پیام توسط ادمین برای یک کاربر، چند کاربر، نقش‌های مشخص یا تمامی کاربران.
- نمایش لیست پیام‌ها برای هر کاربر به همراه وضعیت خوانده‌نشده/خوانده‌شده.
- علامت‌گذاری خودکار پیام‌ها پس از مشاهده و ذخیره زمان مطالعه.
- شمارنده پیام‌های خوانده‌نشده برای نمایش در هدر سایت.
- رویداد `NotificationSent` برای توسعه امکانات لحظه‌ای (Pusher/WebSocket).
- تعریف دسترسی `manage-user-notifications` برای کنترل سطح دسترسی مسیرهای مدیریتی.

## نصب
1. سرویس‌پرووایدر ماژول به صورت خودکار در `bootstrap/providers.php` ثبت شده است.
2. پس از اضافه‌کردن پکیج، دستور زیر را اجرا کنید تا autoload بروزرسانی شود:
   ```bash
   composer dump-autoload
   ```
3. مایگریشن‌ها را اجرا کنید:
   ```bash
   php artisan migrate
   ```
4. در صورت نیاز فایل کانفیگ را پابلیش و تنظیم کنید:
   ```bash
   php artisan vendor:publish --tag=user-notifications-config
   ```

## استفاده از کامپوننت‌ها
- شمارنده پیام‌های خوانده‌نشده:
  ```blade
  <x-user-notifications::unread-indicator :count="$unreadCount" />
  ```
- لیست پیام‌ها (مثلاً در دراپ‌داون هدر):
  ```blade
  <x-user-notifications::notification-list :notifications="$notifications" />
  ```

## دسترسی‌ها
مسیرهای مدیریتی با middleware `can:manage-user-notifications` محافظت می‌شوند. در صورتی که مدل کاربر شما متد `access` را پیاده‌سازی کرده باشد (بر اساس پکیج‌های موجود در پروژه)، این دسترسی از همان متد بررسی می‌شود؛ در غیر این صورت به طور پیش‌فرض دسترسی مجاز است.
